---
    - hosts: localhost
      vars_prompt:
        - name: winserverprvIP
          prompt: Please enter the private IP address of winserver01
          private: no
        - name: azure_adminuser
          prompt: Please enter the admin user for winserver01
          default: azureadmin
          private: no
        - name: azure_password
          prompt: Please enter the admin password fro winserver01
      tasks:
      
      - name: Download and run ConfigureRemotingForAnsible.ps1 to setup WinRM
        psexec:
          hostname: '{{winserverprvIP}}'
          connection_username: '{{azure_adminuser}}'
          connection_password: '{{azure_password}}'
          encrypt: yes
          executable: powershell.exe
          arguments: '-'
          stdin: |
            $ErrorActionPreference = "Stop"
            $sec_protocols = [Net.ServicePointManager]::SecurityProtocol -bor [Net.SecurityProtocolType]::SystemDefault
            $sec_protocols = $sec_protocols -bor [Net.SecurityProtocolType]::Tls12
            [Net.ServicePointManager]::SecurityProtocol = $sec_protocols
            $url = "https://github.com/ansible/ansible/raw/devel/examples/scripts/ConfigureRemotingForAnsible.ps1"
            Invoke-Expression ((New-Object Net.WebClient).DownloadString($url))
            exit
        delegate_to: localhost